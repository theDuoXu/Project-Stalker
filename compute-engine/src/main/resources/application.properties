# --- DATASOURCE & HIKARI CP ---
# Spring Boot usa Hikari por defecto, pero aquí lo hacemos explícito y lo tuneamos.

spring.datasource.type=com.zaxxer.hikari.HikariDataSource
spring.datasource.url=jdbc:postgresql://localhost:5432/projectstalker_db
spring.datasource.username=postgres
spring.datasource.password=postgres
spring.datasource.driver-class-name=org.postgresql.Driver

# Configuración Fina de HikariCP para Alto Rendimiento
# Mínimo de conexiones inactivas esperando queries
spring.datasource.hikari.minimum-idle=5
# Máximo de conexiones reales a la BD (ajustar según tu CPU y Postgres)
spring.datasource.hikari.maximum-pool-size=20
# Tiempo máximo de vida de una conexión (evita problemas de leaks)
spring.datasource.hikari.max-lifetime=1800000
# Tiempo de espera para conseguir una conexión (30s)
spring.datasource.hikari.connection-timeout=30000
# Nombre del pool para identificarlo en los logs/métricas
spring.datasource.hikari.pool-name=StalkerComputeHikariPool

# --- JPA / HIBERNATE ---
# Necesario para que funcione @JdbcTypeCode(SqlTypes.JSON) con PostgreSQL
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# --- SEGURIDAD OAUTH2 / KEYCLOAK ---
# La URL base de tu reino (Realm). Spring añadirá automáticamente /.well-known/openid-configuration
spring.security.oauth2.resourceserver.jwt.issuer-uri=https://auth.protonenergyindustries.com/realms/project-stalker

# Mapeo de nombres (para que el log sea claro)
spring.application.name=compute-engine

# --- CONFIGURADOR DEL SERVIDOR ---
server.servlet.context-path=/projectstalker
server.port=9090

# --- MODO PRUEBAS ---
spring.profiles.active=mock